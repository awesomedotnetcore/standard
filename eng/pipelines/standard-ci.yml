parameters:
  name: ''
  pool: {}
  strategy: {}
  targetOS: ''

jobs:
  - job: ${{ parameters.name }}
    variables:
      # OS Specific commands
      ${{ if eq(parameters.targetOS, 'Windows_NT') }}:
        _buildScript: build.cmd -c -ci
      ${{ if ne(parameters.targetOS, 'Windows_NT') }}:
        _buildScript: ./build.sh --ci
      ${{ if ne(variables['System.TeamProject'], 'public') }}:
        _privateParams: /p:dummy=private
      ${{ if eq(variables['System.TeamProject'], 'public') }}:
        _publicParams: /p:dummy=public

    pool:
      ${{ insert }}: ${{ parameters.pool }}
    strategy:
      maxParallel: 99
      ${{ insert }}: ${{ parameters.strategy }}

    steps:
      - script: $(_buildScript) $(_privateParams) $(_publicParams)
        displayName: Build